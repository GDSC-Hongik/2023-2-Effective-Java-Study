# 프로그램의 동작을 스레드 스케줄러에 기대지 말라

```
💡 견고성과 이식성을 모두 해치는 행위다.
```

## 이식성 좋은 프로그램을 작성하는 방법

- 정확성이나 성능이 스레드 스케줄러에 따라 달라지는 프로그램 → 다른 플랫폼에 이식하기 어려움
- 실행 가능한 스레드의 평균적인 수 < 프로세서 수
- 실행 준비가 된 스레드 → 맡은 작업을 완료할 때까지 계속 실행되도록

### 스레드는 당장 처리해야 할 작업이 없다면 실행돼서는 안 된다

- 실행 가능한 스레드 수를 적게 유지하는 기법
- 각 스레드가 작업을 완료한 후에 다음 일거리가 생길 때까지 대기하게 하기
- 실행자 프레임워크 → 스레드 풀 크기 적절히 설정, 작업은 짧게 유지

### 스레드는 절대 바쁜 대기 상태가 되면 안 된다

- 공유 객체의 상태가 바뀔 때까지 쉬지 않고 검사하면 x
- 스레드 스케줄러의 변덕에 취약
- 프로세서에 큰 부담

```java
public void await() {
	while (true) {
		synchronized(this) {
			if (count == 0)
				return;
		}
	}
}
```

### Thread.yield를 써서 문제를 고쳐보려는 유혹을 떨쳐내자

- 증상이 어느 정도 호전될 수는 있음
- **BUT** 이식성은 x
- 테스트할 수단 x

### 스레드의 우선순위를 조율하면 안 된다

- 오히려 이식성 ↓
- 심각한 응답 불가 문제를 스레드 우선순위로 해결하려는 시도 → 절대 합리적이지 않음 !