# 상속보다는 컴포지션을 사용하라
---

상속은 코드를 재사용하기에 좋은 수단이지만, 잘 못 사용하면 오류를 내기 쉽다.

## 어떨 때 상속을 사용하면 좋을까?
* 같은 프로그래머가 통제하는 패키지 안이라면 상속은 안전하다.
* 확장할 목적으로 설계되었고 문서화도 잘 되었다면 안전하다.


하지만 일반적으로 클래스가 다른 패키지의 클래스를 상속하는 일은 위험하다.
## 메서드 호출과 달리 상속은 캡슐화를 깨뜨린다.
다시 말하면, 상위 클래스가 어떻게 구현하냐에 따라 하위 클래스의 동작에 이상이 생길 수 있다.
즉 상위 클래스의 변경으로, 아무것도 안 건드린 하위 클래스가 오작동할 수 있다.
따라서 

## 메서드를 재정의 할 때
메서드를 재정의 한다면 그 하위 클래스는 그에 대해 영향을 받을 수 있고, 
상위 클래스에 새로운 메서드를 추가한다면, 이 때 하위 클래스는 이에 대해 재정의 하지 않은 상태가 되며, 이 새로운 메서드를 사용해 허용되지 않은 원소를 추가할 수도 있다.
## 메서드 재정의 대신 새로운 메서드를 추가해도 안된다.
1. 하위 클래스에 추가한 메서드와 시그니처가 같고 반환 타입이 다르면 컴파일되지 않는다.
2. 반환 타입까지 같다면 매서드를 재정의한 꼴이므로 위와 동일한 상황이다.
3. 또한 상위 클래스를 새로 만들면, 하위 클래스는 이 메서드가 존재하지도 않았으니, 상위 클래스의 메서드가 요구하는 규약을 만족하지 못할 가능성이 크다.
## 컴포지션을 사용하자
컴포지션이란 기존의 클래스를 확장하는 대신에 새로운 클래스를 만들어, private 필드로 기존 클래스의 인스턴스를 참조하게하는 것이다.
여기서 기존 클래스가 새로운 클래스의 구성요소이므로 compostion이라고 한다.

여기서 새 클래스의 메서드는, 기존 클래스의 메서드를 호출하여 나온 결과를 반환한다. 이를 전달방식(forwarding)이라고 한다.
또한 이렇게 새 클래스의 메서드들을 전달 메서드라고 한다.

이렇게 하면 새 클래스는 기존 클래스의 구현 방식을 벗어나, 자유롭게 메서드를 추가해도 된다.

## 래퍼 클래스
다른 인스턴스를 감싸고 있는 클래스를 래퍼 클래스라고 하며, 
다른 인스턴스에 계측 기능을 덧 씌운다는 뜻에서 데코레이션 패턴이라고 한다.

## 결론
상속을 사용할 때는 하위 클래스가 상위 클래스의 진짜 하위 타입일 경우에만 사용하며, 그 외에는 컴포지션을 사용하자
상속을 사용하면 내부 구현을 불필요하게 노출하는 꼴이며, 성능도 제한된다.