### Item85 : 자바 직렬화의 대안을 찾으라

###### 직렬화, 역직렬화
- 직렬화 : 자바 객체를 바이트 스트림으로 인코딩하는 작업
- 역직렬화 : 직렬화의 반대 작업으로서 바이트 스트림으로부터 객체를 재구성하는 작업

###### 역직렬화의 문제점
공격받을 수 있는 범위가 너무 넓고 그 범위가 지속적으로 넓어져서 방어하기가 어렵다는 근본적인 문제가 있다.

`ObjectInputStream` 의 `readObject` 메서드를 호출하면 바이트 스트림으로부터 객체 그래프가 재구성된다.
그 말인 즉 해당 바이트 스트림에 포함된 모든 클래스의 객체가 재구성될 수 있다는 말이고 이를 다시 말하면
해당 바이트 스트림에 포함된 모든 클래스의 객체가 위협에 노출된다는 소리다.

###### 해결책
그렇다면 직렬화/역직렬화가 가지는 위험성을 해결할 수 있는 방법은 무엇이 있을까?  

- 너무나 당연한 말이지만 역직렬화를 하지 않으면 된다.  
자바에서 제공하는 `직렬화/역직렬화` 대신 `객체-바이트 스트림` 간의 변환을 가능하게 해주는 
또다른 매커니즘을 이용하면 된다.  
저자는 이를 `cross-platform structured-data representation` 이라고 칭하는데 이 방식은
객체 그래프를 직렬화/역직렬화하는 대신 `속성-값` 쌍을 이용하여 구성된 간단한 형태의 데이터 구조를 이용한다.
(ex. JSON, Protocol Buffers)
 
- 하지만 직렬화/역직렬화가 불가피한 상황이라면  
해당 데이터가 안전한지 검사할 수 있는 객체 역직렬화 필터링을 사용하자(ObjectInputFilter)  
위 기능을 이용하면 바이트 스트림 역직렬화 시도 직전에 필터를 설치하는데 이 필터는 클래스 단위에서 특정 클래스를 수용하거나 거부할 수 있다.  
'블랙 리스트'에 포함된 잠재적 위험 클래스를 제외할 수 있고 '화이트 리스트'에 포함된 안전 클래스만 수용할 수 있다. 

## 핵심 정리
    직렬화는 위험성을 내포하므로 되도록이면 사용하지 말자.
    사용해야 한다면 신뢰할 수 없는 바이트 스트림은 역직렬화하지 말고 
    객체 역직렬화 필터링을 사용하여 수용/거부할 클래스를 분리하자.