### Item84 : 프로그램의 동작을 스레드 스케줄러에 기대지 마라

특정 프로세스에 사용되는 스레드가 여러 개일 경우 각 스레드가 얼마만큼의 작업 시간을 할당받는지는 
운영체제의 스레드 스케줄러에 의해 결정된다.  
이 스레드 스케줄러는 각 운영체제마다 상이하므로 이에 의존하는 프로그램은 견고성과 이식성이 떨어진다.

###### 견고성, 이식성을 준수하는 프로그램 작성법
견고성, 이식성을 제공하는 프로그램을 작성하는 방법 중 한 가지는 
'실행 가능한 스레드의 평균적인 수를 프로세서의 수보다 너무 많지 않도록 유지하는 것'이다.
이렇게 하면 일단 실행 준비가 된 스레드는 자신이 맡은 역할을 끝까지 수행할 수 있게 되고 운영체제의
스레드 스케줄러의 부담을 줄여준다. 여기서 말하는 '실행 가능한 스레드'의 의미를 헷갈리면 안된다.
- `총 스레드의 수`는 말 그대로 모든 스레드의 수를 의미한다
- `실행 가능한 스레드의 수`는 총 스레드에서 대기 중인 스레드를 제외한 실제 실행이 가능한 스레드의 수를 의미한다

그럼 이 '실행 가능한 스레드의 수'를 적절하게 유지하는 방법은 뭘까?  

스레드가 자신의 작업을 마무리하고 난 뒤 다음 작업을 맡을 때까지 대기하도록 하는 것이다.
즉, 스레드는 처리할 작업이 없다면 실행되어서는 안된다는 뜻이다.  
그리고 스레드는 `busy waiting`을 하면 안된다. 가변 데이터의 상태를 지속해서 확인하는 작업을 하는 것은 
프로세서에 큰 부담을 준다.

그렇다고 해서 '스레드의 우선순위 조정'을 통한 프로그램의 개선을 추구하는 것은 별로 바람직하지 않다.  
정상적으로 잘 동작하는 프로그램에서 '스레드의 우선순위 조정'을 이용하여 약간의 성능 향상을 추구하는 것은 괜찮지만
간신히 동작하는 프로그램을 고치기 위한 수단으로 '스레드의 우선순위 조정'을 이용하는 것은 옳지 않다. 