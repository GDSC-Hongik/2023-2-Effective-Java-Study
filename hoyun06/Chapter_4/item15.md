### Item15 : 클래스와 멤버의 접근 권한을 최소화하라

###### 잘 설계된 컴포넌트
잘 설계된 컴포넌트란..
- 구현과 api의 분리
- 내부 구현의 은닉
- api를 통해서만 다른 컴포넌트와 소통
- 즉, 캡슐화가 잘 되어 있는 컴포넌트

###### 캡슐화의 장점
크게 보면  
> **시스템을 구성하는 컴포넌트들을 `독립적으로 개발`할 수 있으며 각 컴포넌트의 
`테스트, 최적화` 등의 작업을 개별적으로 수행할 수 있다**

주 장점은 각 컴포넌트를 개별적으로 개발할 수 있다는 것이다.

###### 자바가 제공하는 캡슐화 매커니즘
자바는 접근 제어 매커니즘을 통해 캡슐화를 제공한다.
- 접근 제어 매커니즘
  - 클래스, 인터페이스, 멤버의 접근성을 명시하는 것
  - 각 요소의 접근성은 해당 요소가 선언된 위치와 접근 제한자를 통해 결정된다.

###### 접근 제어 매커니즘
기본 원칙은 '모든 멤버와 클래스의 접근성을 최대한 좁혀라'다. 우리가 의도한대로 동작하는 선에서 최대한
접근성을 좁히라는 의미다.
- `톱레벨 클래스, 인터페이스`
  - 톱레벨 클래스와 인터페이스에 적용 가능한 접근 제한자는 public, package-private이다.
  - public 선언 시 공개 api가 되므로 만약 외부에서 해당 클래스를 사용할 일이 없다면 package-private으로 선언하는 것이 좋다.
  - 만약 package-private으로 선언된 클래스 혹은 인터페이스가 오직 한 클래스에서만 사용된다면 해당 클래스의 내부에 private static 선언하자.
  그러면 해당 클래스에서만 접근할 수 있다.
- `멤버`  
멤버에 부여할 수 있는 접근 제한자는 4 가지가 있다. 접근 범위가 좁은 것부터
  - private (해당 멤버가 선언된 톱레벨 클래스에서만 접근 가능)
  - package-private (해당 멤버가 선언된 패키니 내에서만 접근 가능)
  - protected (package-private의 접근 수준 + 해당 멤버가 선언된 클래스의 서브 클래스에서만 접근 가능)
  - public (어디서나 접근 가능)

멤버의 접근 제한을 package-private에서 protected로 풀어주면 갑자기 접근 범위가 엄청 늘어나게 된다.
그리고 public 클래스의 protected 멤버는 공개 api에 속하므로 계속해서 해당 지원해야 한다. 그러므로 꼭 필요한 경우가 아니라면
protected 멤버는 최대한 적게 유지하는 것이 좋다.

위에서 말하길 접근성은 우리 프로그램이 의도한대로 동작하는 선에서 최대한 좁히는 것이 좋다라고 했다.  
하지만 자바에서는 이것을 막는 구조가 하나 있다.  

> 서브 클래스에서 메소드 오버라이딩을 할 땐 그 접근 수준을 슈퍼 클래스보다 좁혀서 재정의할 수 없다.

위 제약은 리스코프 치환 원칙을 위해선 꼭 필요한 제약이라고 한다.  
`리스코프 치환 원칙`
- 쉽게 말해 슈퍼 타입의 인스턴스는 언제라도 서브 타입의 인스턴스로 대체되어 정상적으로 사용될 수 있어야 한다는 뜻이다.
- 서브 타입 객체는 최소한 슈퍼 타입이 제공하는 기능에 대해선 정상 동작해야 한다는 뜻도 포함된다.

가끔은 테스트 목적을 위해 특정 멤버를 private 에서 package-private으로 범위를 풀어줘도 된다. 하지만 딱 package-private 까지만 하는 것이 옳다.

###### 주의할 점
- public 클래스의 인스턴스 필드는 되도록이면 public이 되지 않도록 하자
  - 인스턴스 필드가 public으로 선언되면 어디서든지 접근이 가능하다. 즉, 어디서든지 수정이 가능하단 얘기다. 그럼 클래스 자체에서 해당 필드에 대한 
  제어권을 잃어버리는 것과 같으므로 주의하자.
  - 또 public 필드는 thread-safe 하지 않다. 
  - 이 내용은 정적 필드와도 일맥상통한 내용이다. 하지만 정말로 해당 클래스의 추상 개념을 나타내기 위해 public 정적 필드가 필요한 경우 상수의 개념으로
  public static final 필드로 제공하자. 유의할 점은 이 필드는 반드시 기본 타입이나 불변 객체를 참조해야 한다는 것이다. 가변 객체를 참조하면 당연히 
  참조 대상을 바꾸진 못하지만 참조하고 있는 그 객체는 수정할 수 있기 때문이다.

###### 자바 9 모듈
자바 9에서는 패키지들의 묶음인 `모듈` 개념이 추가되면서 새로운 `암묵적 접근 제한 개념`이 생겼다.  
모듈 구조에서는 외부에 공개할(export) 패키지와 공개하지 않을 패키지를 지정할 수 있다. 만약 특정 패키지를 공개하지 않기로 설정하면 그 패키지는 다른 모듈에선 접근이 불가능하다.

그래서 public 클래스의 public 혹은 protected 멤버이더라도 해당 클래스가 들어있는 패키지가 외부 공개 대상이 아니라면 그 public/protected 속성은 해당 모듈 내부로 한정되는 말그대로 암묵적 접근 제한인 것이다.

## 핵심 정리
    항상 접근 범위는 최소한으로 유지하자.