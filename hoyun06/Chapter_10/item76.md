### Item76 : 가능한 한 실패 원자적으로 만들라

###### 실패 원자성
특정 메소드 실행 도중 예외가 발생하여 메소드가 정상적으로 실행되지 않는 경우 해당 객체의 상태를 메소드 호출 전과 동일한 상태로
유지하는 속성.

###### 실패 원자성 달성하는 법
- 불변 클래스로 설계한다
  - 불변 클래스의 객체는 한 번 생성되면 절대 수정될 수 없기 때문에 자동으로 실패 원자성이 달성된다
  - 다만 객체 생성 시점에 문제가 발생한다면 객체 생성이 되지 않을 수 있다
- 실패할 가능성이 있는 로직을 상태 변경 코드 이전에 배치한다
  - 먼저 유효성을 검증한 뒤에 실제 객체 상태를 변경한다면 실패 원자성을 달성할 수 있다
- 객체를 복사하여 로직을 실행하고 문제가 없을 시 원본 객체와 교체한다
  - 이 경우는 '복사' 라는 오버로드가 있기 때문에 복사 작업이 무겁지 않은 경우에 사용하면 효과적이다
- 작업 도중 발생하는 문제를 가로채는 코드를 작성하여 실패 이전의 상태로 되돌린다

###### 실패 원자성 달성 관련 유의할 점
- 항상 실패 원자성을 보장하기란 쉽지 않다
  - 실패 원자성을 달성하기 위한 계산 및 비용이 너무 큰 경우도 존재한다
  - 두 스레드가 동기화없이 특정 객체를 동시에 수정하는 경우 `ConcurrentModificationException`을 catch한다고 해서
    해당 객체가 다시 사용 가능한 것은 아니다. 이미 그 객체의 일관성이 무너졌기 때문이다.